import angr
from angrutils import *
proj = angr.Project('./test', load_options={'auto_load_libs':False})

print("======= Property =======")

print("arch: ", proj.arch)
print("entry_point: ",hex(proj.entry))
print("filename: ", proj.filename)

print("======= loader =======")
print(proj.loader)
print(proj.loader.shared_objects)
print(hex(proj.loader.min_addr))
print(hex(proj.loader.max_addr))
print(proj.loader.main_object)
print(proj.loader.main_object.execstack)
print(proj.loader.main_object.pic)

print("========= loader.block ==========")

block = proj.factory.block(proj.entry)
print(block)
print(block.pp())
print("instructions number:", block.instructions)
print("instructions number:", block.instruction_addrs)


print("========= loader.state ==========")
state = proj.factory.entry_state()

print(state.regs.rip)
print(state.regs.rax)
print(state.mem[proj.entry].long.resolved)

print("========= loader.simulation managers ==========")
simgr = proj.factory.simulation_manager(state)
simgr.step()
print(simgr.active[0].regs.rip)
print(state.regs.rip)

print("======== Analyses ===========")
print(proj.analyses)


